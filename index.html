<html>
<head data-cast-api-enabled="true">
  <meta charset="utf-8">
  <title>videojs-contrib-hls Demo</title>
  <link href="//bootswatch.com/3/slate/bootstrap.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/video.js/7.5.0/video-js.min.css" rel="stylesheet">
  <link rel='stylesheet' href='//cdnjs.cloudflare.com/ajax/libs/video.js-chromecast/2.0.9/videojs-chromecast.css'>

  <link href="css/player.css" rel="stylesheet">

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    
    h2 {
      font-size: 30px;
      word-wrap: break-word;
    }
    
    input {
      margin-top: 15px;
      /*      min-width: 450px;*/
      padding: 5px;
    }
    /*GC*/
    /* M3U Playlist */
    
    #m3uplaylist {
      float: right;
      max-width: 45%;
/*      background-color: #f6f6f6;*/
      padding: 10px;
    }
    
    @media screen and (max-width : 1024px) {     
      #m3uplaylist { max-width: 30%; }
    }   
    
    ul#result {
      padding: 0;
      list-style-type: none;
      height: 580px;
      overflow-x: hidden;
      overflow-y: scroll;
      -webkit-overflow-scrolling: touch;
    }
    
    ul#result li {
      border-bottom: 1px solid #383838;
      margin: 8px 0
    }
    
    .bold {
      font-weight: bold;
    }
    
    /****** MENU ******/
    ul#menu {
        list-style-type: none;
        margin: 0;
        padding: 0;
        overflow: hidden;
        background-color: #cacaca;
    }

    #menu li {
        float: left;
    }

    #menu li a {
        display: block;
        color: black;
        text-align: center;
        padding: 10px;
        text-decoration: none;
    }

    #menu li a:hover {
        background-color: #333;
        color: red;
    }
    
    .active {
        background-color: #333;
        color: red !important;
    }
    
  </style>


</head>

<body>

  <div id="m3uplaylist" class="well">
    <form id="m3uForm" action="fichier.php" method="post">
      <label for="pseudo">Load M3U Playlist</label>
      <ul id="menu">
  			<li><a href="https://bit.ly/IPTVLIVE">Live-TV2</a></li>
        <li><a href="http://pastebin.com/QtUHJ78r">QtUHJ78r</a></li>
        <li><a href="http://pastebin.com/JmcbUbrW">Jmc</a></li>
        <li><a href="http://pastebin.com/1NMjBpQQ">1NM</a></li>
        <li><a href="http://pastebin.com/8wbkQrVi">8wb</a></li>
	    	<li><a href="https://www.netroar.com/IPTV-LIST-9.m3u8.txt">List-9</a></li>
      </ul>
      <input type="text" id="playlists" name="playlists" size="55" value="https://bit.ly/IPTVLIVE" />
      <input type="submit" id="envoyer" value="Get m3u Playlists" />
    </form>
    <div style="margin: 5px 0"></div>
    <ul id="result"></ul>
  </div>
  
  <h2 id="vidTitle">SisCon TV</h2>

  <div id="videoWrapper">

    <video id="vid1" 
           class="video-js vjs-default-skin vjs-fluid" 
           poster="http://i.imgur.com/xxqm7EE.png" 
           controls autoplay preload="none" 
           data-setup='{ 
                       "techOrder": ["html5", "youtube"], 
                       "sources": [{ 
                            "type": "application/x-mpegURL", 
                            "src": "https://5975e06a1f292.streamlock.net:4443/canal7jujuy/ngrp:canal7jujuy_all/playlist.m3u8"
                                  }]
                       }'>
    </video>
  </div>

  <form id=load-url>
    <div class="form-group">
     <label for="urlinput">Video URL:</label>
      <input id="urlinput" type="url" size="65" 
             value="https://5975e06a1f292.streamlock.net:4443/canal7jujuy/ngrp:canal7jujuy_all/playlist.m3u8">
<!--    <button type=submit>Load</button>-->
    <input type="submit" class="button" value=" Load ">
      </div>
  </form>
<!--  <ul id="streamlist"></ul>-->
  
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/video.js/7.5.0/video.min.js'></script>
<script src='https://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js'></script>
<script src="js/Youtube.js"></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/dashjs/2.9.2/dash.all.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-dash/2.10.0/videojs-dash.min.js'></script>
<script src='https://www.gstatic.com/cv/js/sender/v1/cast_sender.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/video.js-chromecast/2.0.9/videojs-chromecast.min.js'></script>

  <!--GC SCRIPT-->
  <script src="js/getm3upls.js"></script>


<!--  <script type="text/javascript" src="js/streamslist.js"></script>-->

  <script>
    
//$(function() { 
    /* LOAD streamlist.js */
//    function listStreams(list, container) {
//      for (var i = 0; i < list.length; i++) {
//        var entry = document.createElement("li");
//        entry.innerHTML = "<a href='#' onclick='return loadStream(\"" + list[i].file + "\")'>" + list[i].title + "</a>";
//        document.getElementById(container).appendChild(entry);
//      }
//    }
//    listStreams(streamslist, "streamlist");
    ////////////////

    // submit
    var loadUrl = document.getElementById('load-url');
    var videoURL = document.getElementById('urlinput');

    loadUrl.addEventListener('submit', function(event) {
      event.preventDefault();

      var vidurl = videoURL.value;

      loadStream(vidurl);

      return false;

    });


    videojs.options.flash.swf = "http://vjs.zencdn.net/swf/5.3.0/video-js.swf";
    //var player = window.player = videojs('vid1');
    var player = videojs('vid1');

    function loadStream(url) {

      // temp add valu to input
      videoURL.value = url;

      var type = getType(url);

      console.log(type); // SHOW TYPE
      console.log(url); // SHOW video URL

      player.src({
        src: url,
        type: type
      });

      return false;
    }



    // RELOAD VIDEO ON CLICK LIVE BUTTON GC
    $(document).on('click', '.vjs-live-display', function() {
      player.src({
        "type": player.currentType(),
        "src": player.currentSrc()
      });
      player.load();
      player.play();
    });
    
    player.on('error', function() {
      console.log('The following error occurred:', this.error());
    });


    /* GC VIDEO TYPE */

    /////////////////////////
    // https://jsfiddle.net/onigetoc/aw9yfrr2/

    var rtmp_suffix = /^rtmp:\/\//;
    var hls_suffix = /\.m3u8/;
    var mp4_suffix = /\.(mp4|m4p|m4v|mov)/i;
    var hds_suffix = /\.f4m/;
    var dash_suffix = /\.mpd/;
    var flv_suffix = /\.flv/;
    var webm_suffix = /\.webm/;

    //var youtube_suffix = /\.youtube.com/;
    //var yt_suffix = /^(?:https?:\/\/)?(?:www\.)?youtube\.com\/watch\?(?=.*v=((\w|-){11}))(?:\S+)?$/;
    var yt_suffix = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
    var dm_suffix = /\.?dailymotion.com/;
    var vm_suffix = /\.?vimeo.com/;
    /* ADVANCED REGEX */
    //      var regVimeo = /^.*(vimeo.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/;
    //      var regDailymotion = /^.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/;
    //      var regMetacafe = /^.*(metacafe.com)(\/watch\/)(d+)(.*)/i;
    //      var youtube_suffix = /(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;

    function getType(url) {

      if (rtmp_suffix.test(url))
        return 'rtmp/mp4';
      if (hls_suffix.test(url))
        return 'application/x-mpegurl';
      if (mp4_suffix.test(url))
        return 'video/mp4';
      if (hds_suffix.test(url))
        return 'application/adobe-f4m';
      if (dash_suffix.test(url))
        return 'application/dash+xml';
      if (flv_suffix.test(url))
        return 'video/flv';
      if (webm_suffix.test(url))
        return 'video/webm';
      if (yt_suffix.test(url))
        return 'video/youtube';
      if (dm_suffix.test(url))
        return 'video/dailymotion';
      if (vm_suffix.test(url))
        return 'video/vimeo';
      console.log('could not guess link type: "' + url + '" assuming mp4');
      //return 'video/mp4';
      return 'video/mp4';
    };

//}); // main function end
    
    
    
  </script>
</body>

</html>
